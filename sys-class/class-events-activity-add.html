<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>金视野系统模板</title>
    <meta name="keywords" content="金视野,教育,平台" />
    <meta name="description" content="金视野开发部,模板,2017" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- basic styles -->

    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/css/font-awesome.min.css" />

    <!--[if IE 7]>
		  <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css" />
	<![endif]-->

    <!-- page specific plugin styles -->
    <!-- <link rel="stylesheet" href="static/vendor/datepicker/bootstrap-datepicker.min.css"> -->

    <!-- fonts -->

    <!-- <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,300" /> -->

    <!-- ace styles -->

    <link rel="stylesheet" href="assets/css/ace.min.css" />
    <link rel="stylesheet" href="assets/css/ace-rtl.min.css" />
    <link rel="stylesheet" href="assets/css/ace-skins.min.css" />

    <!--[if lte IE 8]>
		  <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
	<![endif]-->

    <!-- inline styles related to this page -->
    <link rel="stylesheet" href="static/css/styles-class.css">

    <!-- ace settings handler -->

    <script src="assets/js/ace-extra.min.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->

    <!--[if lt IE 9]>
		<script src="assets/js/html5shiv.js"></script>
		<script src="assets/js/respond.min.js"></script>
	<![endif]-->

</head>

<body>


    <div class="main-container" id="main-container">
        <script type="text/javascript">
            try { ace.settings.check('main-container', 'fixed') } catch (e) { }
        </script>

        <div class="main-container-inner">


            <div class="main-content" style="margin-left: 0px;">

                <!-- 面包屑导航 -->
                <div class="breadcrumbs " id="breadcrumbs">
                    <script type="text/javascript">
                        try { ace.settings.check('breadcrumbs', 'fixed') } catch (e) { }
                    </script>
                    <!--位置-->
                    <ul class="breadcrumb">
                        <li>
                            <i class="icon-home home-icon"></i>
                            <a href="jsywebindex.html">首页</a>
                        </li>
                        <li>
                            <a href="class-index.html">班级管理</a>
                        </li>
                        <li class="active">班级记事</li>
                    </ul>
                    <ul class="breadcrumb pull-right navright">
                        <li>
                            <i class="icon-share-alt icon-color"></i>
                            <a href="javascript:history.go(-1);">返回</a>
                        </li>
                    </ul>
                </div>

                <div class="page-content" style="padding-top: 20px;">

                    <!-- /.page-header -->
                    <div class="row">
                        <div class="col-xs-12">

                            <!-- PAGE CONTENT BEGINS -->

                            <div class="head-title">添加活动</div>

                            <div class="content-edit">

                                <form action="class-events-activity.html" method="" enctype="multipart/form-data">

                                    <div class="center-form">
                                        <div class="form-group">
                                            <label>活动名称：</label>
                                            <input type="text" name="" class="width-lg">
                                        </div>
                                        <div class="form-group">
                                            <label>年份：</label>
                                            <select name="" class="width-sm">
                                                <option value="">2018</option>
                                                <option value="">2017</option>
                                                <option value="">2016</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>学期：</label>
                                            <select name="" class="width-sm">
                                                <option value="">春季</option>
                                                <option value="">秋季</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>日期：</label>
                                            <div class="input-group-box width-sm">
                                                <div class="input-group">
                                                    <input class="form-control date-picker" type="text" value="">
                                                    <span class="input-group-addon">
                                                        <i class="icon-calendar bigger-110"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>等级：</label>
                                            <select name="" class="width-sm">
                                                <option>请选择</option>
                                                <option value="">1</option>
                                                <option value="">2</option>
                                                <option value="">3</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>活动内容：</label>
                                            <textarea name="" rows="5" class="width-lg" placeholder="请输入"></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label>参与人员：</label>
                                            <select name="" class="width-lg">
                                                <option>请选择</option>
                                                <option value="">全班</option>
                                                <option value="">？</option>
                                                <option value="">？</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>优秀人员：</label>
                                            <select name="" class="width-lg">
                                                <option>请选择</option>
                                                <option value="">陈独秀</option>
                                                <option value="">王林</option>
                                                <option value="">李某</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>上传附件：</label>
                                            <input type="file" name="" id="addFileUpload" multiple />
                                            <div class="file-tips">支持拓展名：rar、zip、doc、pdf、jpg...</div>
                                        </div>
                                    </div>

                                    <div>
                                        <button type="button" class="ajax-upload">选择文件</button>
                                        <!-- <button type="button" class="start-upload">开始上传</button> -->
                                        <ul class="preview"></ul>
                                    </div>

                                    <div class="form-actions text-center">
                                        <button class="btn btn-primary btn-sm" type="submit">提交</button>
                                        <button class="btn btn-sm" type="reset">重置</button>
                                    </div>
                                </form>

                            </div>


                            <!-- PAGE CONTENT ENDS -->

                        </div>

                    </div>

                    <!-- /.col -->
                </div>
                <!-- /.page-content -->
            </div>
            <!-- /.main-content -->

            <!-- /#ace-settings-container -->
        </div>
        <!-- /.main-container-inner -->
    </div>
    <!-- /.main-container -->


    <!-- basic scripts -->

    <!--[if !IE]> -->

    <!---->

    <!-- <![endif]-->

    <!--[if IE]>

<![endif]-->

    <!--[if !IE]> -->

    <script type="text/javascript">
        window.jQuery || document.write("<script src='assets/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
    </script>

    <!-- <![endif]-->

    <!--[if IE]>
<script type="text/javascript">
 window.jQuery || document.write("<script src='assets/js/jquery-1.10.2.min.js'>"+"<"+"/script>");
</script>
<![endif]-->

    <script type="text/javascript">
        if ("ontouchend" in document) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/typeahead-bs2.min.js"></script>

    <!-- page specific plugin scripts -->
    <!-- <script src="static/vendor/datepicker/bootstrap-datepicker.min.js"></script> -->

    <!-- ace scripts -->

    <script src="assets/js/ace-elements.min.js"></script>
    <script src="assets/js/ace.min.js"></script>


    <!-- inline scripts related to this page -->
    <!-- <div style="display: none">
        <script src='http://v7.cnzz.com/stat.php?id=155540&web_id=155540' language='JavaScript' charset='gb2312'></script>
    </div> -->

    <script src="static/js/common-class.js"></script>
    <!-- <script src="static/vendor/plupload/plupload.full.min.js"></script> -->

    <script>
    

    (function(obj){
        if(!obj.length) return;

        var flash_swf_url = 'static/vendor/plupload/Moxie.swf',
            silverlight_xap_url = 'static/vendor/plupload/Moxie.xap';

        Import.LoadFileList(['static/vendor/plupload/plupload.full.min.js', 'static/vendor/layer/layer.js'], function () {

            obj.each(function(index, element){
                var $this = $(this),
                    url = 'http://192.168.0.110:8001/upload',
                    max_file_size = '2mb',
                    $upload_btn = $(this).siblings('.start-upload'),
                    $preview = $(this).siblings('ul.preview'),
                    remove_url = "";

                var uploader = new plupload.Uploader({
                    browse_button: element,
                    url: url,
                    max_file_size: max_file_size,
                    flash_swf_url: flash_swf_url,
                    silverlight_xap_url: silverlight_xap_url
                });

                uploader.init();
                
                //当文件添加到上传队列
                uploader.bind('FilesAdded', function (uploader, files) {
                    if(!$upload_btn.length){
                        uploader.start();
                    }
                });
                
                //如果存在上传按钮
                if($upload_btn.length) {
                    $upload_btn.on('click', function(event){
                        uploader.start();
                    });
                }

                //当队列中的某一个文件上传完成后
                uploader.bind('FileUploaded', function (uploader, file, data) {
                    if (data.status === 200) {
                        var res = (Object.prototype.toString.call(data.response) === "[object String]") ? JSON.parse(data.response) : data.response;
                        var imgLi = '<li>'+
                                        '<img src="'+ res.filePath+'"/>'+
                                        '<a href="#" class="remove-file">删除</a>'+
                                    '</li>';
                        $preview.append(imgLi);
                    }
                });

                // 删除文件
                $preview.on('click', '.remove-file', function(){
                    event.preventDefault();
                    var cur_li = $(this).parents('li').first(),
                        data = $(this).data();
                    $.ajax({
                        url: remove_url,
                        type: 'GET',
                        data: '',
                        success: function (res) {
                            if (res.state == 'ok') {
                                cur_li.remove();
                            } else {
                                layer.msg(res.msg || "删除失败！", { icon: 2, anim: 6 });
                            }
                        },
                        error: function () {
                            layer.msg("删除失败！", { icon: 2 });
                        }
                    });
                });

            });

        });

    }($(".ajax-upload")));

    </script>
</body>

</html>